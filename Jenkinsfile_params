pipeline {
    agent any

    parameters {
        string(name: 'COUNT', defaultValue: '2', description: 'Количество версий')
        choice(
            name: 'VERSION_PARAMS',
            description: 'Сгенерированные параметры',
            choices: generateChoices()
        )
    }

    stages {
        stage('Print Parameters') {
            steps {
                script {
                    echo "Выбраны параметры: ${params.VERSION_PARAMS}"
                }
            }
        }
    }
}

def generateChoices() {
    def count = env.COUNT ? env.COUNT.toInteger() : 2
    def params = []
    for (int i = 1; i <= count; i++) {
        params.add("NAME_${i}")
        params.add("TAG_${i}")
        params.add("HASH_${i}")
    }
    return params
}
