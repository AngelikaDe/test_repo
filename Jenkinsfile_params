pipeline {
    agent any

     environment {
        VERSION_PARAMS = generateChoices()  // Assign the generated string here
    }

    parameters {
        string(name: 'VERSION_PARAMS', description: 'Generated parameters') // No defaultValue here
    }

    stages {
        stage('Print Parameters') {
            steps {
                script {
                    echo "Выбраны параметры: ${params.VERSION_PARAMS}"
                }
            }
        }
    }
}

def generateChoices() {
    def count = env.COUNT ? env.COUNT.toInteger() : 2
    def params = []
    for (int i = 1; i <= count; i++) {
        params.add("NAME_${i}:TAG_${i}:HASH_${i}")
    }
    return params.join(', ')  // Convert list to a single string
}
