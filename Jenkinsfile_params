pipeline {
    agent any
    stages {
        stage('User Input') {
            steps {
                script {
                    def versions = []
                    def versionCount = groovyScript """
                        return input(
                            message: 'Сколько версий хотите ввести?',
                            parameters: [string(name: 'COUNT', defaultValue: '1', description: 'Введите количество версий')]
                        ).toInteger()
                    """
                    
                    for (int i = 1; i <= versionCount; i++) {
                        def params = groovyScript """
                            return input(
                                message: "Введите данные для версии ${i}",
                                parameters: [
                                    string(name: "NAME_${i}", description: "Название версии"),
                                    string(name: "TAG_${i}", description: "Тег версии"),
                                    string(name: "HASH_${i}", description: "Хеш версии")
                                ]
                            )
                        """
                        versions << params
                    }

                    echo "Введённые версии: ${versions}"
                }
            }
        }
    }
}
